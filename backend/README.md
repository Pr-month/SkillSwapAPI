# SkillSwap API

REST API для обмена навыками между пользователями на основе Nest.js, PostgreSQL и TypeORM.

---

## Описание

SkillSwap — это платформа, позволяющая пользователям обмениваться навыками. Пользователи могут создавать, просматривать, добавлять в избранное навыки, отправлять заявки на обмен, а также получать уведомления в реальном времени.

### Основные возможности:
- Регистрация и авторизация (JWT, refresh token)
- CRUD операции с навыками
- Заявки на обмен навыками
- Добавление навыков в избранное
- Категории навыков (включая подкатегории)
- Загрузка и удаление изображений (ограничение 2МБ)
- Уведомления через WebSocket
- Поддержка пагинации и фильтрации по категориям и ключевым словам
- Swagger документация
- Логирование запросов и ошибок
- Защита роутов через Guard'ы (роли: USER / ADMIN)

---

## Технологии

- **Backend**: Nest.js
- **База данных**: PostgreSQL + TypeORM
- **Аутентификация**: JWT (Access/Refresh Token)
- **WebSocket**: Уведомления в реальном времени
- **Файлы**: Multer для загрузки изображений
- **Документация**: Swagger
- **Логгирование**: Winston
- **Тестирование**: Jest (unit + e2e)
- **CI/CD**: GitHub Actions
- **Деплой**: Vercel / Railway / Render

---

## Требования к окружению

- Node.js v18.x
- npm или yarn
- PostgreSQL 14+
- Docker (опционально)
- Git

---

## Установка

### Установка зависимостей

npm install

Создайте файл .env на основе .env.example: cp .env.example .env

Пример содержимого .env:
PORT=3000
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_USER=postgres
DATABASE_PASSWORD=postgres
DATABASE_NAME=skillswap
JWT_SECRET=mysecretkey
JWT_EXPIRATION=3600


## Запуск проекта
### Локальный запуск: 
npm run start:dev

Через Docker (если используется): docker-compose up -d


## Линтер и форматтер
npm run lint
npm run format

## E2E Тесты

Сквозные тесты выполняются командой `npm run test:e2e`.

### Настройка e2e тестов

Каждый раз перед запуском тестов все таблицы (включая данные) будут удаляться, поэтому для сквозных (e2e) тестов **рекомендуется использовать отдельную БД**!

Для начала создайте с помощью pgAdmin (или из консоли) отдельную базу данных, для удобства используйте того же пользователя которого Вы используете для разработки (скорее всего он указан у Вас в `.env` файле). Имя базы данных может быть любым, например *SkillSwapTest*.

Затем создайте в корне проекта файл `.env.test.local` и поместите в него имя тестовой базы данных в таком виде:

```bash
DATABASE_NAME=SkillSwapTest
```

Этого достаточно, если Вы использовали того же пользователя. Все остальные настройки тестовая среда подтянет из Вашего `.env` файла. Если пользователь, или какие-то другие настройки отличаются - добавьте их в этот файл так же как Вы добавляли их в `.env`, что бы перебить их значения для тестовой среды.
